! FRR BGP Configuration for AWS-S2S-VPN
! Generated by VPN Optimizer

frr version 8.0
frr defaults traditional
hostname AWS-S2S-VPN-gateway
log syslog informational
service integrated-vtysh-config

! Enable BFD
bfd
 peer 169.254.191.145/30
  no shutdown
 !
 peer 169.254.225.45/30
  no shutdown
 !
!

router bgp 65016
 bgp router-id 169.254.191.146/30
 bgp log-neighbor-changes
 no bgp default ipv4-unicast
 
 ! BGP Timers
 timers bgp 10 30
 
 ! Graceful Restart
 bgp graceful-restart
 
 ! AWS Tunnel 1 Neighbor
 neighbor 169.254.191.145/30 remote-as 64512
 neighbor 169.254.191.145/30 timers 10 30
 neighbor 169.254.191.145/30 timers connect 10
 neighbor 169.254.191.145/30 bfd
 
 ! AWS Tunnel 2 Neighbor
 neighbor 169.254.225.45/30 remote-as 64512
 neighbor 169.254.225.45/30 timers 10 30
 neighbor 169.254.225.45/30 timers connect 10
 neighbor 169.254.225.45/30 bfd
 
 ! IPv4 Unicast Address Family
 address-family ipv4 unicast
  ! Enable ECMP
  maximum-paths 4
  
  ! Activate neighbors
  neighbor 169.254.191.145/30 activate
  neighbor 169.254.225.45/30 activate
  
  ! Advertise local networks
  network 192.168.8.0/21
 !
 exit-address-family
!

! Prefix lists for route filtering
ip prefix-list ALLOW-LOCAL-NETS seq 5 permit 0.0.0.0/0 le 32
ip prefix-list ALLOW-AWS-NETS seq 5 permit 0.0.0.0/0 le 32

! Route maps
route-map AWS-IN permit 10
 match ip address prefix-list ALLOW-AWS-NETS
!
route-map AWS-OUT permit 10
 match ip address prefix-list ALLOW-LOCAL-NETS
!

line vty
!
